<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 http://www.john-ros.com/Rcourse/memory.html | BIG DATA ANALYSIS IN R TRAINING (BUSARA)</title>
  <meta name="description" content="This the text material that will accompany the trainign." />
  <meta name="generator" content="bookdown 0.16.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 http://www.john-ros.com/Rcourse/memory.html | BIG DATA ANALYSIS IN R TRAINING (BUSARA)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This the text material that will accompany the trainign." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 http://www.john-ros.com/Rcourse/memory.html | BIG DATA ANALYSIS IN R TRAINING (BUSARA)" />
  
  <meta name="twitter:description" content="This the text material that will accompany the trainign." />
  

<meta name="author" content="EDWIN KAGEREKI" />


<meta name="date" content="2019-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="taking-r-to-the-limit.html"/>
<link rel="next" href="beyond-the-limits.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Big Data Training in R - Busara</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> INTRODUCTION</a><ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.0.1</b> R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Understanding R’s Performance</a><ul>
<li class="chapter" data-level="2.0.1" data-path="intro.html"><a href="intro.html#understanding-memory"><i class="fa fa-check"></i><b>2.0.1</b> Understanding Memory</a></li>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>2.1</b> R Markdown</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#including-plots"><i class="fa fa-check"></i><b>2.2</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="taking-r-to-the-limit.html"><a href="taking-r-to-the-limit.html"><i class="fa fa-check"></i><b>3</b> Taking R to the limit</a></li>
<li class="chapter" data-level="4" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html"><i class="fa fa-check"></i><b>4</b> <a href="http://www.john-ros.com/Rcourse/memory.html" class="uri">http://www.john-ros.com/Rcourse/memory.html</a></a><ul>
<li class="chapter" data-level="4.1" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#managing-io"><i class="fa fa-check"></i><b>4.1</b> Managing I/O</a><ul>
<li class="chapter" data-level="4.1.1" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#size-of-csv-file-689.4mb-7009728-rows-29-columns"><i class="fa fa-check"></i><b>4.1.1</b> size of csv file: 689.4MB (7,009,728 rows * 29 columns)</a></li>
<li class="chapter" data-level="4.1.2" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#benchmark-of-methods-for-file-import-and-export"><i class="fa fa-check"></i><b>4.1.2</b> benchmark of methods for file import and export</a></li>
<li class="chapter" data-level="4.1.3" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#import-of-plain-text-formats"><i class="fa fa-check"></i><b>4.1.3</b> Import of plain text formats</a></li>
<li class="chapter" data-level="4.1.4" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#versatile-data-import-with-rio"><i class="fa fa-check"></i><b>4.1.4</b> Versatile data import with rio</a></li>
<li class="chapter" data-level="4.1.5" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#divide-and-rule-preprocessing-text-outside-r"><i class="fa fa-check"></i><b>4.1.5</b> Divide and rule: Preprocessing text outside R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#efficiently-set-up-pcs."><i class="fa fa-check"></i><b>4.2</b> Efficiently set-up PCs.</a></li>
<li class="chapter" data-level="4.3" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#efficiently-write-r-codes."><i class="fa fa-check"></i><b>4.3</b> Efficiently write R codes.</a><ul>
<li class="chapter" data-level="4.3.1" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#tips"><i class="fa fa-check"></i><b>4.3.1</b> TIPS</a></li>
<li class="chapter" data-level="4.3.2" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#avoid-duplication"><i class="fa fa-check"></i><b>4.3.2</b> Avoid duplication</a></li>
<li class="chapter" data-level="4.3.3" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#code-organisation"><i class="fa fa-check"></i><b>4.3.3</b> Code organisation</a></li>
<li class="chapter" data-level="4.3.4" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#memory-allocation"><i class="fa fa-check"></i><b>4.3.4</b> Memory allocation</a></li>
<li class="chapter" data-level="4.3.5" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#the-byte-compiler"><i class="fa fa-check"></i><b>4.3.5</b> The byte compiler</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#design-efficient-workflows."><i class="fa fa-check"></i><b>4.4</b> Design efficient workflows.</a></li>
<li class="chapter" data-level="4.5" data-path="httpwww-john-ros-comrcoursememory-html.html"><a href="httpwww-john-ros-comrcoursememory-html.html#code-optimisation"><i class="fa fa-check"></i><b>4.5</b> code optimisation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="beyond-the-limits.html"><a href="beyond-the-limits.html"><i class="fa fa-check"></i><b>5</b> Beyond the limits</a><ul>
<li class="chapter" data-level="5.1" data-path="beyond-the-limits.html"><a href="beyond-the-limits.html#introduction-to-hadoop-architecture."><i class="fa fa-check"></i><b>5.1</b> Introduction to Hadoop architecture.</a></li>
<li class="chapter" data-level="5.2" data-path="beyond-the-limits.html"><a href="beyond-the-limits.html#introduction-to-spark."><i class="fa fa-check"></i><b>5.2</b> Introduction to Spark.</a></li>
<li class="chapter" data-level="5.3" data-path="beyond-the-limits.html"><a href="beyond-the-limits.html#running-in-spark."><i class="fa fa-check"></i><b>5.3</b> Running in Spark.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="principles-of-big-data-analysis.html"><a href="principles-of-big-data-analysis.html"><i class="fa fa-check"></i><b>6</b> Principles of big data analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="principles-of-big-data-analysis.html"><a href="principles-of-big-data-analysis.html#data-sources."><i class="fa fa-check"></i><b>6.1</b> Data sources.</a></li>
<li class="chapter" data-level="6.2" data-path="principles-of-big-data-analysis.html"><a href="principles-of-big-data-analysis.html#create-retrieve-and-manage-big-data."><i class="fa fa-check"></i><b>6.2</b> Create, retrieve and manage big data.</a></li>
<li class="chapter" data-level="6.3" data-path="principles-of-big-data-analysis.html"><a href="principles-of-big-data-analysis.html#run-typical-big-data-analysis-descriptive-and-models-using-r."><i class="fa fa-check"></i><b>6.3</b> Run typical big data analysis: descriptive and models using R.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualization-and-deployment.html"><a href="visualization-and-deployment.html"><i class="fa fa-check"></i><b>7</b> Visualization and deployment</a><ul>
<li class="chapter" data-level="7.1" data-path="visualization-and-deployment.html"><a href="visualization-and-deployment.html#unique-aspects-of-big-data-visualization."><i class="fa fa-check"></i><b>7.1</b> Unique aspects of big data visualization.</a></li>
<li class="chapter" data-level="7.2" data-path="visualization-and-deployment.html"><a href="visualization-and-deployment.html#introduction-to-reactive-tables-and-graphs."><i class="fa fa-check"></i><b>7.2</b> Introduction to reactive tables and graphs.</a></li>
<li class="chapter" data-level="7.3" data-path="visualization-and-deployment.html"><a href="visualization-and-deployment.html#deployment-platforms-web-applications-reports-mobile-applications."><i class="fa fa-check"></i><b>7.3</b> Deployment platforms: Web applications, reports, mobile applications.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="planning-and-implementing-big-data-analysis.html"><a href="planning-and-implementing-big-data-analysis.html"><i class="fa fa-check"></i><b>8</b> Planning and implementing Big Data analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="planning-and-implementing-big-data-analysis.html"><a href="planning-and-implementing-big-data-analysis.html#need-assessment."><i class="fa fa-check"></i><b>8.1</b> Need assessment.</a></li>
<li class="chapter" data-level="8.2" data-path="planning-and-implementing-big-data-analysis.html"><a href="planning-and-implementing-big-data-analysis.html#designing-a-workflow."><i class="fa fa-check"></i><b>8.2</b> Designing a workflow.</a></li>
<li class="chapter" data-level="8.3" data-path="planning-and-implementing-big-data-analysis.html"><a href="planning-and-implementing-big-data-analysis.html#case-scenarios."><i class="fa fa-check"></i><b>8.3</b> Case scenarios.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIG DATA ANALYSIS IN R TRAINING (BUSARA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="httpwww.john-ros.comrcoursememory.html" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> <a href="http://www.john-ros.com/Rcourse/memory.html" class="uri">http://www.john-ros.com/Rcourse/memory.html</a></h1>
<p><a href="http://adv-r.had.co.nz/Profiling.html#avoid-copies" class="uri">http://adv-r.had.co.nz/Profiling.html#avoid-copies</a></p>
<p><a href="https://kbroman.org/blog/2017/04/30/sqlite-feather-and-fst/" class="uri">https://kbroman.org/blog/2017/04/30/sqlite-feather-and-fst/</a></p>
<div id="managing-io" class="section level2">
<h2><span class="header-section-number">4.1</span> Managing I/O</h2>
<p>There are other methods of data input like the scan() that will not be discussed here.</p>
<p>Firstly, this post will go deeper into the ways of getting data from common sources, which is often spreadsheet-like data, into R. Just like with the previous post, the focus will be on reading data into R that is different from Excel or any other type of files.</p>
<p>Next, the data from other sources like statistical software, databases, web scraping, etc. will be discussed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### size of csv file: 689.4MB (7,009,728 rows * 29 columns) <span class="al">###</span>


### readcsv&lt;-system.time(read.csv(&#39;APRILDATA.csv&#39;, header = T))
 

### readcsv2&lt;-system.time(read_csv(&#39;APRILDATA.csv&#39;, header = T))

###library(data.table)
### system.time(fread(&#39;APRILDATA.csv&#39;, header = T, sep = &#39;,&#39;)) 

###library(bigmemory)
###system.time(read.big.matrix(&#39;APRILDATA.csv&#39;, header = T))

###library(ff)
###system.time(read.csv.ffdf(file = &#39;APRILDATA.csv&#39;, header = T))

###library(sqldf)
###system.time(read.csv.sql(&#39;APRILDATA.csv&#39;))</code></pre></div>
<div id="size-of-csv-file-689.4mb-7009728-rows-29-columns" class="section level3">
<h3><span class="header-section-number">4.1.1</span> size of csv file: 689.4MB (7,009,728 rows * 29 columns)</h3>
<p>Importing datasets into R, and exporting them to the world outside the R ecosystem, can be a time-consuming and frustrating process. If the process is tricky, slow or ultimately unsuccessful, this can represent a major inefficiency right at the outset of a project.</p>
<p>Conversely, reading and writing your data efficiently will make it much easier for your R projects to interact with the outside world. This section explains how to efficiently read a wide range of datasets into R.</p>
<p><strong>Say something about the diversity of the data sources</strong></p>
<p><strong>Good Practice tips</strong></p>
<p>Before reading in a single line of data, however, it is worth considering a general principle for reproducible data management: never modify raw data files. Raw data should be seen as read-only, and contain information about its provenance. Keeping the original file name and commenting on its origin are a couple of ways to improve reproducibility, even when the data are not publicly available.</p>
</div>
<div id="benchmark-of-methods-for-file-import-and-export" class="section level3">
<h3><span class="header-section-number">4.1.2</span> benchmark of methods for file import and export</h3>
</div>
<div id="import-of-plain-text-formats" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Import of plain text formats</h3>
<p>There is often more than one way to read data into R. A simple .csv, for example, file can be imported using a wide range of methods, with implications for computational efficiency. This section investigates methods for getting data into R, with a focus on delimited text formats, as these are ubiquitous, and a focus on three approaches:</p>
<ul>
<li>base R’s plain text reading functions such as read.delim, which are derived from read.table;</li>
<li>data.table approach, which uses the function fread;</li>
<li>readr package which provides read_csv and other read_ functions such as read_tsv.</li>
</ul>
<p>Although this section is focussed on reading text files, it demonstrate the wider principle that the speed and flexibility advantages of additional read functions can be offset by the disadvantages of addition package dependency (in terms of complexity and maintaining the code) for small datasets. The real benefits kick in on large datasets. Of course, there are some data types that require a certain package to load in R: the readstata13 package, for example, was developed solely to read in .dta files generated by versions of Stata 13 and above.</p>
</div>
<div id="versatile-data-import-with-rio" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Versatile data import with rio</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="kw">rep</span>(<span class="st">&quot;images/swiss-army.jpg&quot;</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="images/swiss-army.jpg" /><!-- --></p>
<p>The rio package is a relatively recent R package, developed by Thomas J. Leeper, which makes data import and export in R painless and quick.</p>
<p>This objective is mainly reached when rio makes assumptions about the file format. This means that the rio package guesses the format of the file you are trying to import and consequently applies import functions appropriate to that format.</p>
<p>All of this is done behind the scenes, and the user is just required to run the import() function.</p>
<p>As Leeper often states when talking about the package: “it just works.”</p>
<p>One of the great results you can obtain by employing this package is streamlining workflows involving different development and productivity tools.</p>
<p>For instance, it is possible to produce tables directly into sas and make them available to the R environment without any particular export procedure in sas, we can directly acquire data in R as it is produced, or input into an Excel spreadsheet.</p>
</div>
<div id="divide-and-rule-preprocessing-text-outside-r" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Divide and rule: Preprocessing text outside R</h3>
<p>There are circumstances when datasets become too large to read directly into R. For example reading in a 4 GB text file using the functions tested above, for example, consumes all available RAM on a 16 GB machine. To overcome this limitation, <em>external stream processing tools</em> can be used to preprocess large text files. The following command, using the Linux command line ‘shell’ (or Windows based Linux shell emulator Cygwin) command split, for example, will break a large multi GB file into many chunks, each of which is more manageable for R:</p>
<p>Go to tools - shell, then run the code:</p>
<p>split -bxm nameoffile.csv</p>
<p>The result is a series of files, set to 100 MB each with the -b100m argument in the above code. By default these will be called xaa, xab and can be read in one chunk at a time (e.g. using read.csv(), fread() or read_csv(), described in the previous section) without crashing most modern computers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pryr)
<span class="kw">system.time</span>(data&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data3.csv&quot;</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.252   0.020   0.278</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">saveRDS</span>(data, <span class="st">&quot;co2.Rds&quot;</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.084   0.000   0.085</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(db_clone &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;co2.Rds&quot;</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.028   0.000   0.028</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;feather&quot;</span>)
<span class="kw">system.time</span>(<span class="kw">write_feather</span>(data, <span class="st">&quot;co2.feather&quot;</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.008   0.004   0.015</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(db_clone &lt;-<span class="st"> </span><span class="kw">read_feather</span>(<span class="st">&quot;co2.feather&quot;</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##   0.008   0.000   0.009</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">object_size</span>(db_clone)</code></pre></div>
<pre><code>## 7.27 MB</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">###read.table.timing &lt;- system.time(read.table(csv.name, header = TRUE, sep = &quot;,&quot;))
###readr.timing &lt;- system.time(read_delim(csv.name, &quot;,&quot;, col_names = TRUE))
###data.table.timing &lt;- system.time(allData &lt;- fread(csv.name, showProgress = FALSE))
###data &lt;- data.frame(method = c(&#39;read.table&#39;, &#39;readr&#39;, &#39;fread&#39;), 
###                  timing = c(read.table.timing[3], readr.timing[3], data.table.timing[3]))

X =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="fl">1e2</span>), <span class="dt">nrow =</span> <span class="fl">1e2</span>))
r1 =<span class="st"> </span><span class="kw">lapply</span>(X, median)
r2 =<span class="st"> </span>parallel<span class="op">::</span><span class="kw">mclapply</span>(X, median) </code></pre></div>
<p>Split and save as feather or RDS</p>
<p>TIPS: <a href="https://inbo.github.io/tutorials/tutorials/r_large_data_files_handling/#sqldftit" class="uri">https://inbo.github.io/tutorials/tutorials/r_large_data_files_handling/#sqldftit</a></p>
<ul>
<li><p>If you can comfortably work with the entire file in memory, but reading the file is rather slow, consider using the data.table package and read the file with its fread function.</p></li>
<li>If your file does not comfortably fit in memory:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Use sqldf if you have to stick to csv files.</li>
<li>Use a SQLite database and query it using either SQL queries or dplyr.</li>
<li>Convert your csv file to a sqlite database in order to query</li>
</ol>
<p>fread and read_delim are indeed much faster then the default read.table. However, the result of fread is a data.table and the result of read_delim is a tibble. Both are not a data.frame. The data.table package describes the data.table object as a more performant replacement for the data.frame. This means that selecting, filtering and aggregating data is much faster on a data.table compared to the standard data.frame but it requires you to use a slightly different syntax. A tibble is very similar to a data.frame, but provides more convenience when printing or subsetting the data table.</p>
<p><strong>x is the number of mbs that you want ot split the data to</strong></p>
</div>
</div>
<div id="efficiently-set-up-pcs." class="section level2">
<h2><span class="header-section-number">4.2</span> Efficiently set-up PCs.</h2>
<p>An efficient computer set-up is analogous to a well-tuned vehicle. Its components work in harmony. It is well-serviced. It’s fast!</p>
</div>
<div id="efficiently-write-r-codes." class="section level2">
<h2><span class="header-section-number">4.3</span> Efficiently write R codes.</h2>
<p>In this section we will discuss “big picture” programming techniques. We cover general concepts and R programming techniques about code optimisation, before describing idiomatic programming structures. We conclude the chapter by examining relatively easy ways of speeding up code using the compiler package and parallel processing, using multiple CPUs.</p>
<div id="tips" class="section level3">
<h3><span class="header-section-number">4.3.1</span> TIPS</h3>
<ul>
<li>Avoid duplication</li>
<li>Code organisation</li>
<li></li>
</ul>
</div>
<div id="avoid-duplication" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Avoid duplication</h3>
<p>A pernicious source of slow R code is growing an object with a loop. Whenever you use c(), append(), cbind(), rbind(), or paste() to create a bigger object, R must first allocate space for the new object and then copy the old object to its new home. If you’re repeating this many times, like in a for loop, this can be quite expensive. You’ve entered Circle 2 of the “R inferno”.</p>
</div>
<div id="code-organisation" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Code organisation</h3>
<p><a href="http://adv-r.had.co.nz/Profiling.html#code-organisation" class="uri">http://adv-r.had.co.nz/Profiling.html#code-organisation</a></p>
</div>
<div id="memory-allocation" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Memory allocation</h3>
<p><a href="https://csgillespie.github.io/efficientR/programming.html" class="uri">https://csgillespie.github.io/efficientR/programming.html</a></p>
</div>
<div id="the-byte-compiler" class="section level3">
<h3><span class="header-section-number">4.3.5</span> The byte compiler</h3>
<p><a href="https://csgillespie.github.io/efficientR/programming.html" class="uri">https://csgillespie.github.io/efficientR/programming.html</a></p>
</div>
</div>
<div id="design-efficient-workflows." class="section level2">
<h2><span class="header-section-number">4.4</span> Design efficient workflows.</h2>
</div>
<div id="code-optimisation" class="section level2">
<h2><span class="header-section-number">4.5</span> code optimisation</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="taking-r-to-the-limit.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beyond-the-limits.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
